#! /usr/bin/python

__help1__ = '''
   
purpose => pip [install | uninstall] [-h | --help] [-a | --all] [--megdc | megdc] [--megamnilavu | megamnilavu] [--megamcommon] [--megamsnowflake] [--megamgulpd] [--megamd] [--megamgateway]
'''
__help2__= '''
                   
COMMAND ...

Megam Data Center

optional arguments:
  -h, --help            	show this help message and exit
  -a, --all             	install all the megam packages
  --megamnilavu,megamnilavu	install package megamnilavu for UI
  --megamd			install package megamd for Megam engine
  --megamgateway		install package megamgateway for queue maintanance
.....

commands:
  COMMAND               description
    megam		Megam systems service.
    install             Install megam packages on remote hosts.
    uninstall           Remove megam packages from remote hosts.
    
Full documentation can be found at: console.megam.io
''' 

__install_all__='''

apt-get -y install megamnilavu >> $MEGAM_LOG

echo "export MEGAM_HOME=/var/lib/megam" >> /home/cibadmin/.bashrc
source /home/cibadmin/.bashrc

sudo apt-add-repository -y ppa:openjdk-r/ppa >> $MEGAM_LOG

sudo apt-get -y update >> $MEGAM_LOG

sudo apt-get -y install openjdk-8-jdk >> $MEGAM_LOG

sudo echo 3 > /proc/sys/vm/drop_caches

apt-get -y install megamgateway >> $MEGAM_LOG

apt-get -y install chef-server >> $MEGAM_LOG
sudo echo 3 > /proc/sys/vm/drop_caches
megamd_preinstall >> $MEGAM_LOG

apt-get -y install rabbitmq-server || true >> $MEGAM_LOG

cat > //etc/rabbitmq/rabbitmq-env.conf <<EOF
NODENAME=megamd
EOF

service rabbitmq-server restart >> $MEGAM_LOG
sudo echo 3 > /proc/sys/vm/drop_caches
apt-get -y install megamd >> $MEGAM_LOG

service_restart >> $MEGAM_LOG

apt-get -y install megamanalytics >> $MEGAM_LOG

export DEBIAN_FRONTEND=noninteractive

sudo echo 3 > /proc/sys/vm/drop_caches

apt-get -y install megammonitor >> $MEGAM_LOG

echo "`date`: Step1: megam installed successfully." >> $MEGAM_LOG
'''


