from ceph_deploy.util import paths
from ceph_deploy import conf
from ceph_deploy.lib import remoto
from StringIO import StringIO
from ceph_deploy.util import constants


def ceph_version(conn):
    """
    Log the remote ceph-version by calling `ceph --version`
    """
    return remoto.process.run(conn, ['megdc', '--version'])


def map_components(notsplit_packages, components):
    """
    Returns a list of packages to install based on component names

    This is done by checking if a component is in notsplit_packages,
    if it is, we know we need to install 'ceph' instead of the
    raw component name.  Essentially, this component hasn't been
    'split' from the master 'ceph' package yet.
    """
    packages = set()

    for c in components:
        if c in notsplit_packages:
            packages.add('megam')
        else:
            packages.add(c)

    return list(packages)
